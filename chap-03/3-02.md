Preparando a tabela `nota_pontos`:

```
DROP TABLE nota_pontos;

CREATE TABLE nota_pontos (
  grade VARCHAR(2) PRIMARY KEY,
  points DECIMAL(3,2)
);

INSERT INTO nota_pontos (grade, points) VALUES
  ('A', 4.0),
  ('A-', 3.7),
  ('B+', 3.3),
  ('B', 3.0),
  ('B-', 2.7),
  ('C+', 2.3),
  ('C', 2.0),
  ('C-', 1.7),
  ('D', 1.3),
  ('D-', 1.0),
  ('E', 0.7),
  ('E-', 0.3),
  ('F', 0.0);

SELECT * FROM nota_pontos;
```

## 3.02 - a)

```
SELECT COALESCE(SUM(n.points * c.credits), 0)
FROM takes t
JOIN nota_pontos n ON n.grade = t.grade
JOIN course c ON c.course_id = t.course_id
WHERE t.id = '12345'
```

## 3.02 - b)

```
SELECT COALESCE(SUM(n.points * c.credits)/SUM(c.credits), 0)
FROM takes t
JOIN nota_pontos n ON n.grade = t.grade
JOIN course c ON c.course_id = t.course_id
WHERE t.id = '12345'
```

## 3.02 - c)

```
SELECT t.id, COALESCE(SUM(n.points * c.credits)/SUM(c.credits), 0)
FROM takes t
JOIN nota_pontos n ON n.grade = t.grade
JOIN course c ON c.course_id = t.course_id
GROUP BY t.id
```

## 3.02 - d)

As soluções apresentadas não geram linhas para a junção entre `takes` e
`nota_pontos`, então esses casos não afetariam o cálculo da soma, nem da
média.

Caso um aluno não possua cursos registrados, nenhuma linha seria retornada.
Então o resultado seria `NULL`. No entanto, a cláusula `COALESCE`
garante que, nesta situação, o resultado seja 0.
