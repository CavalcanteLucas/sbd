drop table nota_pontos;

create table nota_pontos (
  grade varchar(2) primary key,
  points decimal(3,2)
);

insert into nota_pontos (grade, points) values
  ('A', 4.0),
  ('A-', 3.7),
  ('B+', 3.3),
  ('B', 3.0),
  ('B-', 2.7),
  ('C+', 2.3),
  ('C', 2.0),
  ('C-', 1.7),
  ('D', 1.3),
  ('D-', 1.0),
  ('E', 0.7),
  ('E-', 0.3),
  ('F', 0.0);

select * from nota_pontos

-- a
select coalesce(sum(n.points * c.credits), 0)
from takes t
join nota_pontos n on n.grade = t.grade
join course c on c.course_id = t.course_id
where t.id = '12345'

-- b
  
select coalesce(sum(n.points * c.credits)/sum(c.credits), 0)
from takes t
join nota_pontos n on n.grade = t.grade
join course c on c.course_id = t.course_id
where t.id = '12345'

-- c
select t.id, coalesce(sum(n.points * c.credits)/sum(c.credits), 0)
from takes t
join nota_pontos n on n.grade = t.grade
join course c on c.course_id = t.course_id
group by t.id

-- d
"""
As soluções apresentadas não geram linhas para a junção entre `takes` e
`nota_pontos`, então esses casos não afetariam o cálculo da soma, nem da
média.

Caso um aluno não possua cursos registrados, nenhuma linha seria retornada.
Então o resultado seria NULL. No entanto, a cláusula `COALESCE`
garante que, nesta situação, o resultado seja 0.
"""