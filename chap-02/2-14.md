# 2.14

Considere o banco de dados de funcionários da Figura 2.17. Dê uma expressão na álgebra relacional para expressar cada uma das seguintes consultas:

**a)** Ache o nome de todos os funcionários que trabalham para o "BigBank".

**b)** Ache o nome e a cidade de residência de todos os funcionários que trabalham para o "BigBank".

**c)** Ache o nome, o endereço e a cidade de residência de todos os funcionários que trabalham para o "BigBank" e recebem mais de $10.000.

**d)** Ache o nome de todos os funcionários neste banco de dados que moram na mesma cidade da empresa para a qual trabalham.

## Resposta

**a)**

$$
\begin{align*}
&\prod\nolimits_{nome\_pessoa}(\sigma_{nome\_empresa="Big\ Bank"}(trabalha))
\end{align*}
$$

**b)**

$$
\begin{align*}
&\prod\nolimits_{nome\_pessoa}(\sigma_{nome\_empresa="Big\ Bank"}( \\
&\qquad trabalha\bowtie_{nome\_pessoa}funcionário \\
&))
\end{align*}
$$

**c)**

$$
\begin{align*}
&\prod\nolimits_{nome\_pessoa, endereço, cidade}( \\
&\qquad\sigma_{nome\_empresa="Big\ Bank" \wedge\ salário\ >\ 10.000}( \\
&\qquad\qquad trabalha \\
&\qquad\qquad\bowtie_{trabalho.nome\_pessoa=funcionário.nome\_pessoa} funcionário \\
&\qquad) \\
&)
\end{align*}
$$

**d)**

$$
\begin{align*}
&\prod\nolimits_{nome\_pessoa}( \\
&\qquad\sigma_{e.cidade=f.cidade}( \\
&\qquad\qquad \rho_f(funcionário) \\
&\qquad\qquad\bowtie_{f.nome\_pessoa=t.nome\_pessoa} \rho_t(trabalha)\\
&\qquad\qquad\bowtie_{t.nome\_empresa=e.nome\_empresa} \rho_e(empresa)\\
&\qquad) \\
&)
\end{align*}
$$
